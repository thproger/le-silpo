<div class="import-card shadow-sm">
  <h5 class="mb-3 font-monospace fw-bold text-muted">
    {{ isParsed && selectedFile ? selectedFile.name : '...' }}
  </h5>

  <div class="content-area mb-4">
    @if (isParsed) {
      <div class="table-responsive border rounded" style="height: 350px; overflow-y: auto">
        <table class="table table-sm table-bordered m-0">
          <thead class="table-dark sticky-top">
            <tr>
              <th class="text-center bg-secondary border-secondary" style="width: 50px">#</th>
              @for (letter of tableLetters; track letter) {
                <th class="text-center">{{ letter }}</th>
              }
            </tr>
          </thead>
          <tbody>
            <tr class="table-light fw-bold">
              <td class="bg-dark text-white text-center">1</td>
              @for (h of headers; track h) {
                <td>{{ h }}</td>
              }
            </tr>
            @for (row of previewData; track i; let i = $index) {
              <tr>
                <td class="bg-dark text-white text-center">{{ i + 2 }}</td>
                @for (h of headers; track h) {
                  <td>{{ row[h] }}</td>
                }
              </tr>
            }
          </tbody>
        </table>
      </div>
    } @else {
      <div
        class="drop-zone"
        (click)="fileInput.click()"
        (dragover)="$event.preventDefault(); isDragging = true"
        (dragleave)="isDragging = false"
        (drop)="$event.preventDefault(); isDragging = false; onFileSelected($event)"
        [class.dragover]="isDragging"
      >
        <span>Click or drag to import a file</span>
        <input
          #fileInput
          type="file"
          class="d-none"
          (change)="onFileSelected($event)"
          accept=".csv"
        />
      </div>
    }
  </div>

  <div class="row g-3">
    <div class="col-md-6">
      <div class="input-group">
        <input
          type="text"
          class="form-control py-3 bg-white"
          [value]="isParsed ? selectedFile?.name : 'Add to Order list'"
          readonly
        />
        <button
          class="btn px-4 d-flex align-items-center justify-content-center"
          [disabled]="!isParsed"
          (click)="uploadData()"
          [ngClass]="isParsed ? 'btn-teal active-upload' : 'btn-secondary disabled-btn'"
        >
          <i class="bi bi-upload text-white fs-5"></i>
        </button>
      </div>
    </div>

    <div class="col-md-6">
      <div class="input-group">
        <input
          type="text"
          class="form-control py-3 bg-white"
          [value]="isParsed ? 'Cancel file selection' : 'No file selected'"
          readonly
        />
        <button
          class="btn px-4 d-flex align-items-center justify-content-center"
          (click)="reset()"
          [disabled]="!isParsed"
          [ngClass]="isParsed ? 'btn-danger' : 'btn-secondary disabled-btn'"
        >
          <i class="bi bi-x-lg text-white fs-5"></i>
        </button>
      </div>
    </div>
  </div>
</div>
